<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>हैंड जेस्चर कंट्रोल</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f9;
            color: #333;
            overflow: hidden;
            position: relative; /* पेज व्यू को सही ढंग से पोजीशन करने के लिए */
        }
        
        /* पेज व्यू स्टाइलिंग */
        .page-view {
            display: none;
            width: 100%;
            height: 100vh;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute; 
            top: 0;
            left: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f4f4f9;
            z-index: 10;
        }
        .page-view.active {
            display: flex;
        }

        /* सामान्य कंटेनर स्टाइलिंग */
        .content-container {
            text-align: center;
            padding: 30px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 90%;
        }

        h1 {
            color: #1a1a1a;
            margin-bottom: 20px;
            font-size: 2em;
        }
        p#info {
            margin-bottom: 25px;
            font-size: 1.1em;
            color: #555;
            line-height: 1.6;
        }
        #button-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px;
        }
        .button {
            padding: 15px 25px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            background-color: #007aff;
            color: white;
            border-radius: 8px;
            transition: transform 0.2s ease, background-color 0.2s ease;
            font-weight: 600;
            min-width: 120px;
        }
        .button:hover, .button.hover-active {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        
        /* नेविगेशन बटन के लिए विशिष्ट स्टाइल */
        .nav-button {
            background-color: #34c759; /* हरे रंग का बटन */
            margin-top: 30px;
            font-size: 20px;
            padding: 18px 40px;
        }
        .nav-button:hover, .nav-button.hover-active {
            background-color: #2a9d4a;
        }

        /* कर्सर स्टाइलिंग */
        #cursor {
            position: absolute;
            width: 25px;
            height: 25px;
            background-color: rgba(255, 59, 48, 0.7);
            border: 2px solid white;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            display: none; 
            transition: background-color 0.2s, transform 0.2s;
            z-index: 9999;
        }
        #cursor.clicked {
            background-color: rgba(52, 199, 89, 0.9);
            transform: translate(-50%, -50%) scale(1.4);
        }
        /* कैमरा व्यू को छिपाने के लिए */
        .input_video {
            display: none;
        }
    </style>
    <!-- MediaPipe लाइब्रेरी इम्पोर्ट करें -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
</head>
<body>

    <!-- कैमरा फ़ीड के लिए वीडियो एलिमेंट -->
    <video class="input_video"></video>

    <!-- 1. स्वागत पेज 1 -->
    <div id="welcome-page-1" class="page-view active">
        <div class="content-container">
            <h1>फिंगर कंट्रोल सिस्टम में आपका स्वागत है</h1>
            <p id="info">यह एप्लिकेशन आपको हैंड जेस्चर (हाथ के इशारों) का उपयोग करके बटन पर क्लिक करने की अनुमति देता है।<br>आगे बढ़ने के लिए 'Get Started' पर क्लिक करें।</p>
            <button class="button nav-button" data-target="welcome-page-2" onclick="navigateTo('welcome-page-2')">Get Started</button>
        </div>
    </div>

    <!-- 2. स्वागत पेज 2 (निर्देश) -->
    <div id="welcome-page-2" class="page-view">
        <div class="content-container">
            <h1>निर्देश (Instructions)</h1>
            <p id="info">कैमरे के सामने अपनी <strong>तर्जनी (Index Finger)</strong> उंगली का प्रयोग करें।<br>कर्सर को स्थानांतरित करने के लिए उंगली को घुमाएँ।<br>किसी बटन पर <strong>क्लिक</strong> करने के लिए अंगूठे और तर्जनी को मिलाएं (चुटकी काटें)।</p>
            <button class="button nav-button" data-target="main-control-page" onclick="navigateTo('main-control-page')">Get Started</button>
        </div>
    </div>

    <!-- 3. मुख्य नियंत्रण पेज -->
    <div id="main-control-page" class="page-view">
        <div class="content-container">
            <h1>हैंड जेस्चर कंट्रोल</h1>
            <p id="info">तर्जनी (Index Finger) से बटन पर जाएँ, और क्लिक करने के लिए चुटकी काटें।</p>

            <div id="button-container">
                <button class="button link-button" onclick="openNewPage('https://www.google.com')">Google</button>
                <button class="button link-button" onclick="openNewPage('https://www.youtube.com')">YouTube</button>
                <button class="button link-button" onclick="openNewPage('https://www.wikipedia.org')">Wikipedia</button>
                <button class="button link-button" onclick="openNewPage('https://github.com')">GitHub</button>
                <button class="button link-button" onclick="openNewPage('https://www.amazon.com')">Amazon</button>
                <button class="button link-button" onclick="openNewPage('https://www.facebook.com')">Facebook</button>
                <button class="button link-button" onclick="openNewPage('https://twitter.com')">Twitter</button>
                <button class="button link-button" onclick="openNewPage('https://www.instagram.com')">Instagram</button>
                <button class="button link-button" onclick="openNewPage('https://www.linkedin.com')">LinkedIn</button>
            </div>
        </div>
    </div>

    <!-- यह कर्सर उंगली को फॉलो करेगा -->
    <div id="cursor"></div>

    <script>
        // DOM एलिमेंट्स को चुनें
        const videoElement = document.querySelector('.input_video');
        const cursor = document.getElementById('cursor');

        let isPinched = false;
        let lastHoveredButton = null;

        // पेज बदलने का फंक्शन
        function navigateTo(pageId) {
            document.querySelectorAll('.page-view').forEach(page => {
                page.classList.remove('active');
                page.style.display = 'none';
            });
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
                targetPage.style.display = 'flex';
            }

            // अगर मुख्य नियंत्रण पेज पर आ गए हैं, तो कर्सर दिखाएं
            if (pageId === 'main-control-page' || pageId === 'welcome-page-2') {
                // इन पृष्ठों पर कर्सर दिखाई देगा, हालांकि welcome-page-1 पर इसकी आवश्यकता नहीं है।
            } else {
                 // अन्य पृष्ठों पर कर्सर छिपा दें
                 cursor.style.display = 'none';
            }
        }

        // लिंक बटन के लिए फंक्शन
        function openNewPage(url) {
            window.open(url, '_blank');
        }
        
        // नेविगेशन बटन क्लिक हैंडलर (क्लिक इवेंट फिंगर जेस्चर से ट्रिगर होगा)
        function handleNavigationClick(buttonElement) {
             const targetPageId = buttonElement.getAttribute('data-target');
             if (targetPageId) {
                navigateTo(targetPageId);
             }
        }


        // जब MediaPipe हाथ का पता लगाता है तो यह फंक्शन चलता है
        function onResults(results) {
            
            // केवल सक्रिय पेज पर ही कर्सर और ट्रैकिंग दिखाएं
            const activePage = document.querySelector('.page-view.active');
            if (!activePage || activePage.id === 'welcome-page-1') {
                cursor.style.display = 'none';
                if(lastHoveredButton) {
                    lastHoveredButton.classList.remove('hover-active');
                    lastHoveredButton = null;
                 }
                return; 
            }
            
            cursor.style.display = 'none'; 

            if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                const landmarks = results.multiHandLandmarks[0];
                
                const indexFingerTip = landmarks[8];
                const thumbTip = landmarks[4];
                
                // normalized निर्देशांक (0 से 1) को स्क्रीन पिक्सेल में बदलें (मिररिंग के लिए 1 - x)
                const x = window.innerWidth * (1 - indexFingerTip.x);
                const y = window.innerHeight * indexFingerTip.y;
                
                cursor.style.display = 'block';
                cursor.style.left = `${x}px`;
                cursor.style.top = `${y}px`;
                
                const elementUnderCursor = document.elementFromPoint(x, y);

                // होवर इफ़ेक्ट को मैनेज करें
                if (lastHoveredButton && lastHoveredButton !== elementUnderCursor) {
                    lastHoveredButton.classList.remove('hover-active');
                    lastHoveredButton = null;
                }
                
                if (elementUnderCursor && elementUnderCursor.classList.contains('button')) {
                    elementUnderCursor.classList.add('hover-active');
                    lastHoveredButton = elementUnderCursor;
                }
                
                // चुटकी (पिंच) के इशारे का पता लगाएं
                const distance = Math.sqrt(
                    Math.pow(indexFingerTip.x - thumbTip.x, 2) +
                    Math.pow(indexFingerTip.y - thumbTip.y, 2)
                );
                
                const pinchThreshold = 0.04; 

                if (distance < pinchThreshold) {
                    // अगर चुटकी अभी-अभी शुरू हुई है
                    if (!isPinched) {
                        isPinched = true;
                        cursor.classList.add('clicked');
                        
                        if (lastHoveredButton) {
                           // नेविगेशन बटन के लिए
                           if(lastHoveredButton.classList.contains('nav-button')) {
                               handleNavigationClick(lastHoveredButton);
                           } 
                           // लिंक बटन के लिए (मुख्य पेज पर)
                           else if (lastHoveredButton.classList.contains('link-button')) {
                               lastHoveredButton.click();
                           }
                        }
                    }
                } else {
                    // जब चुटकी खत्म हो जाए
                    if (isPinched) {
                        isPinched = false;
                        cursor.classList.remove('clicked');
                    }
                }
            } else {
                 // अगर कोई हाथ नहीं मिला, तो होवर इफ़ेक्ट हटा दें
                 if(lastHoveredButton) {
                    lastHoveredButton.classList.remove('hover-active');
                    lastHoveredButton = null;
                 }
            }
        }

        // MediaPipe Hands को कॉन्फ़िगर करें
        const hands = new Hands({
            locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
        });

        hands.setOptions({
            maxNumHands: 1, 
            modelComplexity: 1,
            minDetectionConfidence: 0.7,
            minTrackingConfidence: 0.7
        });

        // रिजल्ट के लिए कॉलबैक सेट करें
        hands.onResults(onResults);

        // कैमरे को शुरू करें
        const camera = new Camera(videoElement, {
            onFrame: async () => {
                await hands.send({ image: videoElement });
            },
            width: 640,
            height: 480
        });
        camera.start();

        // शुरुआत में पहले पेज पर सेट करें
        navigateTo('welcome-page-1');

    </script>

</body>
</html>
